import{d as F,r as f,_ as w,o as e,aR as z,aM as B,aN as H,aI as W,R as j,n as Y,B as u,I as J,b4 as K,c as y,e as Q,T as G,b5 as g,b6 as A,ax as $,aV as E,aW as h,aT as k}from"../vendor-6f7c0435.js";import{n as p,A as C,o as X}from"../kernel-7232a489.js";const x="Converter",Z="0.0.1",I="conversion-graph",ee={week:"Semana",day:"Dia",h:"H",m:"m",s:"s",ms:"ms"},te={scales:{time:{name:"time",base:"m",factors:{s:1/60,m:1,h:60,d:1440}},length:{name:"length",base:"meters",factors:{cm:.001,m:1,km:1e3}},area:{name:"area",base:"m2",factors:{cm2:1e4,m2:1}},volume:{name:"volume",base:"l",factors:{ml:1e3,l:1}}}},ne=F({name:x,initialState:te,reducers:{},extraReducers:t=>{}}),se=[{type:"UNIT",label:"Unidade",description:"Adiciona um tipo de unidade simples"},{type:"COMPOUND_UNIT",label:"Unidade composta",description:"Adiciona um tipo de unidade composta"},{type:"SCALE",label:"Escala",description:"Adiciona um tipo de escala"}],oe=()=>{const t=p("Graph"),{useGraph:n}=t.hooks,s=n(I,o=>o),a=f.useCallback(o=>{switch(o){case"UNIT":s.actions.addNode({type:"UNIT",id:w.uniqueId(o.toLowerCase()),name:"Nova unidade",position:{x:0,y:0},abbreviation:"new-unit"});break;case"SCALE":s.actions.addNode({type:"SCALE",id:w.uniqueId(o.toLowerCase()),name:"Nova escala",position:{x:0,y:0}});break;case"COMPOUND_UNIT":s.actions.addNode({type:"COMPOUND_UNIT",id:w.uniqueId(o.toLowerCase()),name:"Nova unidade composta",abbreviation:"new-compound-unit",position:{x:0,y:0}});break}},[s]);return s.state?e.jsx(z,{role:"list-options",sx:{paddingRight:5,overflow:"auto"},children:se.map(({type:o,label:i,description:r})=>e.jsx(B,{disableGutters:!0,children:e.jsx(H,{primary:i,secondary:r,onClick:()=>a(o),sx:{cursor:"pointer",flexGrow:1}})},o))}):e.jsx(e.Fragment,{})},ae=()=>{const t=p("Layout"),{SettingsPanel:n,Accordion:s}=t.components;return e.jsxs(n,{children:[e.jsx(s,{name:"Nodos",icon:e.jsx(W,{}),summary:"Tipos de nodos disponíveis",children:e.jsx(oe,{})}),e.jsx(e.Fragment,{})]})},ie=({graphId:t})=>{const{hooks:{useResizeObserver:n}}=p("Layout"),{hooks:{useGraph:s}}=p("Graph"),{hooks:{useD3Container:a},d3Components:{Grid:o,ChordPlot:i}}=p("SVG"),r=f.useRef(null),c=f.useRef(null),d=n(c),m=s(t,l=>l),L=f.useMemo(()=>!m.state||!m.state.nodes?{nodes:[],links:[]}:{nodes:Object.values(m.state.nodes).map(l=>({id:l.id,group:l.type,nodeLabel:l.name,strength:-400,x:l.position.x,y:l.position.y,radius:50})),links:Object.values(m.state.edges).map(l=>({id:l.id,type:l.type,source:l.sourceId,target:l.targetId,value:5}))},[m]),_=Y(),[v,b]=[d?.width??700,d?.height??700],q=a().width(v).height(b).underlays([o({xSettings:{range:[-1,v+1],domain:[-1,v+1]},ySettings:{range:[-1,b+1],domain:[-1,b+1]},dimensions:[v,b]})]).content([i({dataTransform:()=>[[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]]})]);return f.useLayoutEffect(()=>{!d||!r.current||q.render({graph:L,theme:_},r.current)},[L,d]),m.state?e.jsx("div",{ref:c,role:"conversion-graph-viewer",style:{height:"100%",width:"100%"},children:e.jsx("svg",{ref:r,id:`${m.id}`,width:"100%",height:"100%"})}):e.jsx(e.Fragment,{})},re=j.memo(ie),ce=({name:t})=>{const n=p("Layout"),{ViewportNotificationsTray:s,DetailsPanel:a}=n.components;return e.jsxs(u,{role:"converter-graph-viewport",sx:{padding:1,height:"100%",position:"relative",overflow:"hidden"},children:[e.jsx(re,{graphId:I}),e.jsx(s,{children:e.jsx(e.Fragment,{})}),e.jsx(ae,{}),e.jsx(a,{children:e.jsx(e.Fragment,{})})]})},O=j.memo(ce),de=()=>{const t=p("Layout"),{useViewportManager:n}=t.hooks,s=n();return e.jsx(e.Fragment,{children:e.jsx(J,{onClick:()=>s.functions.addViewport("Grafo de conversão","ConverterGraphViewport",void 0,"conversion-graph"),children:e.jsx(K,{})})})},D=y(`[${x}:${C.COMMAND}] Load conversion graph`);y(`[${x}:${C.COMMAND}] Select node`);y(`[${x}:${C.EVENT}] Conversion graph loaded`);y(`[${x}:${C.COMMAND}] Node selected`);const P=Q();P.startListening({actionCreator:D,effect:async(t,n)=>{const{dispatch:s}=n;s(X({graphId:I}))}});function le({dispatch:t,managers:{storeManager:n,componentRegistryManager:s,ribbonMenuManager:a}}){n.functions.loadReducer(x,ne.reducer),n.functions.registerMiddleware(P),t(D()),s.functions.registerComponents({ribbonMenuSections:{ConversorGraphSection:j.memo(de)},viewportTypes:{ConverterGraphViewport:O}}),a.functions.addNewTab({label:"Conversor",sectionNames:["ConversorGraphSection"],type:"base"})}function M(t){const n=R(t);return`${n.amount} ${n.unit}`}function R(t){const n=["centavos","R$"];let s=0,a=t;for(;a>=100&&s<n.length-1;)s+=1,a/=100;return{amount:a,unit:n[s]}}function S(t){return t<1e4?Math.round(Math.sqrt(t)):+Math.pow(t/1e3,2).toPrecision(2)}function ue({label:t,icon:n,onChange:s,slots:a}){const[o,i]=j.useState(10),r=(c,d)=>{typeof d=="number"&&(i(d),s(R(S(d)))),c.stopPropagation(),c.preventDefault()};return e.jsxs(u,{sx:{width:250},role:"money-slider",onPointerMove:c=>{c.stopPropagation(),c.preventDefault()},children:[e.jsxs(u,{children:[e.jsxs(G,{id:"money-slider",gutterBottom:!0,children:[t,": ",M(S(o))]}),a?.coumpoundSelector]}),e.jsxs(g,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(g,{item:!0,children:n}),e.jsx(g,{item:!0,xs:!0,children:e.jsx(A,{value:o,min:0,step:.01,max:1e5,marks:[{value:1e4,label:"1 R$"},{value:32e3,label:"10 R$"}],scale:S,getAriaValueText:M,valueLabelFormat:M,onChange:r,valueLabelDisplay:"auto","aria-labelledby":"money-slider"})})]})]})}function T(t){const n=U(t);return`${n.amount} ${n.unit}`}function U(t){const n=["s","m","h","d"],s=[1,60,3600,86400],a=s.findIndex(r=>r>=t),o=Math.max(a<0?3:a-1,0);return{amount:Math.round(t/s[o]),unit:n[o]}}function V(t){let s=t;return t<108e3?s=t/120:t<2*108e3?s=t/240:t>3*108e3&&(s=t),s}function me({label:t,icon:n,onChange:s,slots:a}){const[o,i]=j.useState(10),r=(c,d)=>{typeof d=="number"&&(i(d),s(U(V(d)))),c.stopPropagation(),c.preventDefault()};return e.jsxs(u,{sx:{width:"min-content"},onPointerMove:c=>{c.stopPropagation(),c.preventDefault()},children:[e.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:1},children:[e.jsxs(e.Fragment,{children:[e.jsx($,{id:"quotient-number",size:"small",type:"number",sx:{minWidth:80},InputLabelProps:{shrink:!0},value:100}),e.jsxs(E,{id:"quotient-unit-selector",size:"small",sx:{width:"min-content"},children:[e.jsx(h,{value:"week",children:"Sem."}),e.jsx(h,{value:"day",children:"Dia"}),e.jsx(h,{value:"h",children:"Hr"}),e.jsx(h,{value:"m",children:"min"}),e.jsx(h,{value:"s",children:"sec"})]})]}),e.jsx("span",{children:"/"}),a?.coumpoundSelector]}),e.jsxs(g,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(g,{item:!0,children:n}),e.jsx(g,{item:!0,xs:!0,children:e.jsx(A,{value:o,min:0,step:10,max:432e3,marks:[],scale:V,getAriaValueText:T,valueLabelFormat:T,onChange:r,valueLabelDisplay:"auto","aria-labelledby":"time-slider"})})]})]})}function he({scale:t,...n}){return t==="money"?e.jsx(ue,{...n}):e.jsx(me,{...n})}function N({onChange:t,value:n,children:s,...a}){return e.jsxs(u,{role:"unit-selector",...a,sx:{display:"flex",gap:.2},children:[e.jsx(k,{children:e.jsx($,{id:"amount",size:"small",type:"number",autoComplete:"off",sx:{width:"min-content",minWidth:80},value:n.amount,onChange:o=>t({unit:n.unit,amount:o.target.valueAsNumber})})}),e.jsx(k,{children:e.jsx(E,{id:"unit-selector",inputProps:{id:"unit"},size:"small",sx:{width:"min-content"},onChange:o=>t({amount:n.amount,unit:o.target.value}),value:n.unit,children:s})})]})}function pe({quotientUnitsAvailable:t,dividendUnitsAvailable:n,label:s,value:a,onChange:o}){return e.jsxs(u,{role:"compound-selector",width:"min-content",sx:{display:"flex",gap:2,alignItems:"baseline"},children:[s&&e.jsx(G,{gutterBottom:!0,children:s}),e.jsx(N,{id:"quotient-selector",value:a.quotient,onChange:i=>o({...a,quotient:i}),children:t().map(({value:i,label:r})=>e.jsx(h,{value:i,children:r},i))},"quotient"),e.jsx("span",{children:"/"}),e.jsx(N,{id:"dividend-selector",value:a.dividend,onChange:i=>o({...a,dividend:i}),children:n().map(({value:i,label:r})=>e.jsx(h,{value:i,children:r},i))},"dividend")]})}const xe=()=>({time:Object.entries(ee).map(([t,n])=>({value:t,label:n}))}),ge=({icon:t,value:n})=>e.jsxs(u,{sx:{display:"flex",gap:.3,alignItems:"center"},children:[t&&e.jsx("div",{role:"coumpound-value-icon",children:t}),e.jsxs("div",{role:"coumpound-value-value",children:[n.quotient.amount," ",n.quotient.unit," / ",n.dividend.amount," ",n.dividend.unit]})]}),ve={name:x,version:Z,depends_on:["Graph"],components:{CoverterGraphViewport:O,ScaleSlider:he,CompoundSelector:pe,UnitSelector:N,CompoundUnit:ge},store:{actions:{},middlewares:[],reducers:{}},hooks:{useScales:xe},constants:{},kernelCalls:{startModule:le,restartModule:()=>{},shutdownModule:()=>{}}};export{ve as m};
