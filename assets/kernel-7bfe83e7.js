import{r as g,u as ss,a as os,R as N,c as x,b as D,_ as pe,d as T,e as I,l as te,f as ct,g as dt,s as je,z as lt,h as ns,i as as,j as rs,k as is,m as cs,n as ds,o as r,p as ut,S as ls,q as ot,M as us,A as ps,t as gs,B as E,T as le,v as fs,w as Ee,I as B,x as ue,E as ge,y as hs,C as ms,D as xs,F as ys,G as pt,P as gt,H as ws,J as Ms,K as fe,L as he,N as Z,O as Q,Q as Cs,U as bs,V as Ss,W as $s,X as vs,Y as ks,Z as js,$ as Es,a0 as As,a1 as Rs,a2 as Vs,a3 as Ls,a4 as Ds,a5 as nt,a6 as Os,a7 as Gs,a8 as Ns,a9 as Ts,aa as ft,ab as J,ac as Ps,ad as _s,ae as Is,af as zs,ag as Us,ah as Fs,ai as Bs,aj as Ws,ak as Ys,al as ht,am as qs,an as Hs,ao as Xs,ap as Ks,aq as Zs,ar as Qs,as as Js,at as eo,au as to,av as so,aw as oo,ax as no,ay as ao,az as ro,aA as io,aB as co,aC as lo}from"./vendor-4a2caf03.js";const mt="Store",uo="0.0.1",xt=g.createContext({currentReducers:{},loadReducers:e=>null,registerMiddleware:e=>null}),po=()=>{const{loadReducers:e,registerMiddleware:t}=g.useContext(xt);return{functions:{loadReducer:(o,n)=>{e({[o]:n})},registerMiddleware:o=>{t(o)}}}},yt=()=>ss(),go=os,wt=g.createContext({registries:{},createRegistry:()=>null,createRegistries:()=>null,getComponent:()=>N.memo(()=>null),registerComponents:()=>null}),fo=()=>{const{createRegistry:e,createRegistries:t,getComponent:s,registerComponents:o}=g.useContext(wt);return{functions:{createRegistry:e,createRegistries:t,registerComponents:o,getComponent:s}}},ce={name:mt,version:uo,depends_on:[],managers:{store:po,componentRegistry:fo},hooks:{useAppDispatch:yt,useAppSelector:go},kernelCalls:{startModule:()=>null,restartModule:()=>null,shutdownModule:()=>null}},Ae=g.createContext({modules:{},setModules:()=>null}),y={EVENT:"Event",COMMAND:"Command",DOCUMENT:"Document"},A="Graph",ho="0.0.1",mo=x(`[${A}:Instance:${y.EVENT}] Graph loaded`),xo=x(`[${A}:Instance:${y.EVENT}] Node added`),yo=x(`[${A}:Instance:${y.EVENT}] Node removed`),wo=x(`[${A}:Instance:${y.EVENT}] Node updated`),Mo=x(`[${A}:Instance:${y.EVENT}] Edge added`),Co=x(`[${A}:Instance:${y.EVENT}] Edge removed`),ve=x(`[${A}:Instance:${y.EVENT}] Search finished`),bo=x(`[${A}:Instance:${y.EVENT}] Search invalidated`),Mt=x(`[${A}:Instance:${y.COMMAND}] Load Graph`),Ct=x(`[${A}:Instance:${y.COMMAND}] Reset Graph`),me=x(`[${A}:Instance:${y.COMMAND}] Add node`),xe=x(`[${A}:Instance:${y.COMMAND}] Remove node`),ye=x(`[${A}:Instance:${y.COMMAND}] Update node`),se=x(`[${A}:Instance:${y.COMMAND}] Add edge`),oe=x(`[${A}:Instance:${y.COMMAND}] Remove edge`),bt=x(`[${A}:Instance:${y.COMMAND}] Search`),St=x(`[${A}:Instance:${y.COMMAND}] Invalidate Search`),V=e=>{const{modules:t}=g.useContext(Ae),s=t[e];if(!s)throw Error(`Module ${e} not found`);return s},$t={inputs:{},outputs:{}},we=(e,t)=>{const s=V("Store"),o=s.hooks.useAppDispatch(),n=s.hooks.useAppSelector,a=D(d=>d?.Graph&&d.Graph.graphs[e],t),i=n(a),c=n(d=>d?.Graph&&d.Graph.graphs[e]);return{id:e,state:i,actions:{addNode:(d,u)=>{const l={...d,position:{x:0,y:0}};o(me({graphId:e,node:l,edges:u??$t}))},removeNode:d=>{o(xe({graphId:e,nodeId:d}))},updateNode:d=>{o(ye({graphId:e,nodeId:d.id,changes:d}))},addEdge:d=>{o(se({graphId:e,edge:d}))},updateEdge:(d,u)=>{const l=c?.edges[d];if(l){o(oe({graphId:e,edgeId:d}));const p={...l,...u};o(se({graphId:e,edge:p}))}},removeEdge:d=>{o(oe({graphId:e,edgeId:d}))},nodeExists:d=>c?d in c.nodes:!1,search:(d,u,l,p,m,C,$)=>{const h=$??pe.uniqueId("search");return o(bt({id:h,graphId:e,strategy:d,nodeStart:u,validate:l,stopCriteria:p,depth:m,label:C??h})),h}}}},Re={nodes:{},edges:{},adjacencyList:{},searchResults:{}},vt={graphs:{}};x(`[${A}:${y.EVENT}:Init] Graph Module loaded`);const So=x(`[${A}:GraphsManager:${y.EVENT}] Graph created`),$o=x(`[${A}:GraphsManager:${y.EVENT}] Graph destroyed`),Ve=x(`[${A}:GraphsManager:${y.COMMAND}] Create graph`),kt=x(`[${A}:GraphsManager:${y.COMMAND}] Destroy graph`),vo=T({name:A,initialState:vt,reducers:{},extraReducers:e=>{e.addCase(Mt,(t,{payload:{graphId:s,graph:o}})=>({...t,graphs:{...t.graphs,[s]:o}})),e.addCase(me,(t,{payload:{graphId:s,node:o,edges:n}})=>{const a=t.graphs[s];if(!a)throw Error("Graph does not exist");if(a.nodes[o.id])throw Error("Node already exists");return{...t,graphs:{...t.graphs,[s]:{...a,nodes:{...a.nodes,[o.id]:o},edges:{...a.edges,...Object.entries(n.inputs).reduce((c,[d,u])=>({...c,[d]:u}),{}),...Object.entries(n.outputs).reduce((c,[d,u])=>({...c,[d]:u}),{})},adjacencyList:{...a.adjacencyList,[o.id]:{inputs:Object.keys(n.inputs),outputs:Object.keys(n.outputs)},...Object.entries(n.inputs).reduce((c,[d,u])=>({...c,[u.sourceId]:{...a.adjacencyList[u.sourceId],outputs:[...a.adjacencyList[u.sourceId].outputs,d]}}),{}),...Object.entries(n.outputs).reduce((c,[d,u])=>({...c,[u.targetId]:{...a.adjacencyList[u.targetId],inputs:[...a.adjacencyList[u.targetId].inputs,d]}}),{})}}}}}).addCase(xe,(t,{payload:{graphId:s,nodeId:o}})=>{const n=Object.entries(t.graphs[s].edges).filter(([a,i])=>i.sourceId===o||i.targetId===o).map(([a,i])=>a);return{...t,graphs:{...t.graphs,[s]:{...t.graphs[s],nodes:Object.values(t.graphs[s].nodes).reduce((a,i)=>i.id!==o?{...a,[i.id]:i}:a,{}),adjacencyList:Object.entries(t.graphs[s].adjacencyList).reduce((a,[i,c])=>i!==o?{...a,[i]:{inputs:c.inputs.filter(d=>!n.includes(d)),outputs:c.outputs.filter(d=>!n.includes(d))}}:a,{}),edges:Object.entries(t.graphs[s].edges).reduce((a,[i,c])=>n.includes(i)?a:{...a,[i]:c},{})}}}}).addCase(ye,(t,{payload:{graphId:s,nodeId:o,changes:n}})=>{const a=t.graphs[s],i=a.nodes[o];if(i===null)throw Error("Node does not exist");return a.nodes[o]={...i,...n},t}).addCase(se,(t,{payload:{graphId:s,edge:o}})=>{const n=t.graphs[s];if(n.edges[o.id])throw Error("Edge already exists");return n.edges[o.id]=o,n.adjacencyList[o.sourceId].outputs.push(o.id),n.adjacencyList[o.targetId].inputs.push(o.id),t}).addCase(oe,(t,{payload:{graphId:s,edgeId:o}})=>{const n=t.graphs[s].edges[o];return{...t,graphs:{...t.graphs,[s]:{...t.graphs[s],adjacencyList:Object.entries(t.graphs[s].adjacencyList).reduce((a,[i,c])=>i===n.sourceId||i===n.targetId?{...a,[i]:{inputs:c.inputs.filter(d=>d!==o),outputs:c.outputs.filter(d=>d!==o)}}:{...a,[i]:c},{}),edges:Object.entries(t.graphs[s].edges).reduce((a,[i,c])=>i!==o?{...a,[i]:c}:a,{})}}}}).addCase(Ct,(t,{payload:{graphId:s}})=>({...t,graphs:{...t.graphs,[s]:{id:s,...Re}}})).addCase(ve,(t,{payload:{graphId:s,searchId:o,results:n}})=>({...t,graphs:{...t.graphs,[s]:{...t.graphs[s],searchResults:{...t.graphs[s].searchResults,[o]:n}}}})).addCase(St,(t,{payload:{graphId:s,searchId:o}})=>({...t,graphs:{...t.graphs,[s]:{...t.graphs[s],searchResults:{...t.graphs[s].searchResults,[o]:{...t.graphs[s].searchResults[o],outdated:!0}}}}}))}}),ko=T({name:A,initialState:vt,reducers:{},extraReducers:e=>{e.addCase(Ve,(t,{payload:{graphId:s}})=>{if(s in t.graphs)throw Error();return t.graphs[s]={...Re,id:s},t}).addCase(kt,(t,{payload:{graphId:s}})=>{if(!(s in t.graphs))throw Error();return delete t.graphs[s],t}),e.addDefaultCase(vo.reducer)}}),Le=I();Le.startListening({actionCreator:Ve,effect:async(e,t)=>{const{dispatch:s}=t;s(So(e.payload))}});Le.startListening({actionCreator:kt,effect:async(e,t)=>{const{dispatch:s}=t;s($o(e.payload))}});const jo=(e,t,s,o,n)=>{const a=[],i=[];let c=0;const d=[t];for(;d.length;){const u=d.shift();if(!u)break;const l=e.nodes[u];if(a.push(l),s(l,e,i,a)&&i.push(l),o(l,e,i,a))break;if(n&&c>=n)continue;const m=e.adjacencyList[u];d.push(...m.outputs.map(C=>e.edges[C].targetId)),d.push(...m.inputs.map(C=>e.edges[C].sourceId)),c+=1}return{findings:i,visited:a}},Eo=(e,t,s,o,n)=>({findings:[],visited:[]}),z=I();z.startListening({actionCreator:Mt,effect:async({payload:{graphId:e,graph:t}},s)=>{const{dispatch:o}=s;o(mo({graphId:e,graph:t}))}});z.startListening({actionCreator:me,effect:async({payload:{graphId:e,node:t,edges:s}},o)=>{const{dispatch:n}=o;n(xo({graphId:e,node:t,edges:s}))}});z.startListening({actionCreator:xe,effect:async({payload:{graphId:e,nodeId:t}},s)=>{const{dispatch:o}=s;o(yo({graphId:e,nodeId:t}))}});z.startListening({actionCreator:ye,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(wo(e))}});z.startListening({actionCreator:se,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Mo(e))}});z.startListening({actionCreator:oe,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Co(e))}});z.startListening({actionCreator:bt,effect:async({payload:e},t)=>{const{dispatch:s,getState:o}=t;let{Graph:{graphs:n}}=o(),a=n[e.graphId];if(a.searchResults&&e.id in a.searchResults&&!a.searchResults[e.id].outdated){s(ve({graphId:e.graphId,searchId:e.id,results:a.searchResults[e.id]}));return}let i={findings:[],visited:[]};switch(e.strategy){case"dfs":i={...Eo(a,e.nodeStart,e.validate,e.stopCriteria,e.depth)};break;case"bfs":i=jo(a,e.nodeStart,e.validate,e.stopCriteria,e.depth);break}s(ve({graphId:e.graphId,searchId:e.id,results:{...i,outdated:!1}}))}});z.startListening({actionCreator:St,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(bo(e))}});const k="Layout",Ao="0.0.1",De="ribbonMenuSections",q="viewportTypes",jt="settings-panel",Et="details-panel",At="viewport-notifications-tray";function Ro(e){let t=0;for(let o=0;o<e.length;o++)t=e.charCodeAt(o)+((t<<5)-t);let s="#";for(let o=0;o<3;o++){let n=t>>o*8&171;s+=("00"+n.toString(16)).slice(-2)}return s}const Vo=({width:e,height:t,nodeBorder:s})=>{const o=te().domain([-1,e+1]).range([-1,e+1]),n=te().domain([-1,t+1]).range([-1,t+1]),a=ct(o).ticks((e+2)/(t+2)*10).tickSize(t).tickPadding(8-t),i=dt(n).ticks(10).tickSize(e).tickPadding(8-e);function c(p){p.append("circle").attr("r",m=>m.radius).attr("fill",m=>Ro(m.group??"")).attr("stroke",s),p.append("text").text(m=>m.nodeLabel).attr("text-anchor","middle").attr("fill",s)}function d(p){function m(h){h.active||p.alphaTarget(.3).restart(),h.subject.fx=h.subject.x,h.subject.fy=h.subject.y}function C(h){h.subject.fx=h.x,h.subject.fy=h.y}function $(h){h.active||p.alphaTarget(0),h.subject.fx=null,h.subject.fy=null}return cs().on("start",m).on("drag",C).on("end",$)}function u(p){p.append("line").attr("stroke-width","1em").attr("stroke","gray")}function l(p){p.each(m=>{p.attr("viewBox",[0,0,e,t]),p.selectAll("*").remove(),p.append("defs");const $=p.append("g").attr("role","grid"),h=p.append("g").attr("role","container"),f=$.append("g").attr("class","axis axis--x").attr("stroke-opacity","0.3").attr("stroke-dasharray","6 1").attr("stroke-width","0.5px").call(a),M=$.append("g").attr("class","axis axis--y").attr("stroke-opacity","0.3").attr("stroke-dasharray","6 1").attr("stroke-width","0.5px").call(i),b=lt().scaleExtent([-10,40]).filter(w=>(w.preventDefault(),(!w.ctrlKey||w.type==="wheel")&&!w.button)).on("zoom",({transform:w})=>{h.attr("transform",w),f.call(a.scale(w.rescaleX(o))),M.call(i.scale(w.rescaleY(n)))});p.call(b);const S=ns(m.nodes).force("links",as(m.links).id(w=>w.id).distance(300).strength(1)).force("charge",rs().strength(w=>w.strength)).force("colide",is(w=>w.radius)),R=h.append("g").attr("role","layer").attr("id","links-layer").selectAll("g[role='link']").data(m.links).join(w=>w.append("g").attr("role","link").attr("id",G=>G.id).call(u),w=>w,w=>w.remove()),v=h.append("g").attr("role","layer").attr("id","nodes-layer").selectAll("g[role='node']").data(m.nodes).join(w=>w.append("g").attr("role","node").attr("id",G=>G.id).call(d(S)).call(c),w=>w.select("circle").attr("cx",G=>G.x).attr("cy",G=>G.y),w=>w.remove());S.on("tick",()=>{v.attr("transform",w=>`translate(${w.x}, ${w.y})`),R.selectAll("line").attr("x1",w=>w.source.x).attr("y1",w=>w.source.y).attr("x2",w=>w.target.x).attr("y2",w=>w.target.y)}),S.alpha(1)})}return{render(p,m){je(m).datum(p).call(l)}}},Lo=({graphId:e})=>{const{hooks:{useResizeObserver:t}}=V("Layout"),s=g.useRef(null),o=g.useRef(null),n=t(o),a=we(e,u=>u),i=g.useMemo(()=>!a.state||!a.state.nodes?{nodes:[],links:[]}:{nodes:Object.values(a.state.nodes).map(u=>({id:u.id,group:u.type,nodeLabel:u?.label||u.id,strength:-400,x:u.position.x,y:u.position.y,radius:50})),links:Object.values(a.state.edges).map(u=>({id:u.id,type:u.type,source:u.sourceId,target:u.targetId,value:5}))},[a]),c=ds(),d=Vo({nodeBorder:c.palette.getContrastText(c.palette.background.default),width:n?.width??0,height:n?.height??0});return g.useLayoutEffect(()=>{!n||!s.current||d.render(i,s.current)},[i,n]),a.state?r.jsx("div",{ref:o,role:"graph-viewer",style:{height:"100%",width:"100%"},children:r.jsx("svg",{ref:s,id:`${a.id}`,width:"100%",height:"100%"})}):r.jsx(r.Fragment,{})},Rt=N.memo(Lo),Do=({managers:{storeManager:e,componentRegistryManager:t}})=>{e.functions.loadReducer(A,ko.reducer),e.functions.registerMiddleware(Le),e.functions.registerMiddleware(z),t.functions.createRegistries({[De]:{},[q]:{graph:Rt}})},Oo=()=>{const e=yt();return{functions:{createGraph(t){return e(Ve({graphId:t})),{id:t,state:{id:t,...Re},actions:{addNode:(s,o)=>{const n={...s,position:{x:0,y:0}};e(me({graphId:t,node:n,edges:o??$t}))},removeNode:s=>{e(xe({graphId:t,nodeId:s}))},updateNode:s=>{e(ye({graphId:t,nodeId:s.id,changes:s}))},addEdge:s=>{e(se({graphId:t,edge:s}))},updateEdge:(s,o)=>{console.error("Not implemented yet")},removeEdge:s=>{e(oe({graphId:t,edgeId:s}))},nodeExists:s=>!1,search:()=>"null"}}},resetGraph(t){e(Ct({graphId:t}))}}}},Go=(e,t)=>{const o=t??(n=>n);return D(n=>n.Graph,n=>n&&o(n.graphs[e]))},No=(e,t)=>{const s=V("Graph"),{useGraph:o}=s.hooks,n=o(e,c=>c?.nodes[t]),a=o(e,c=>c?.adjacencyList[t]),i=o(e,c=>Object.values(c?.edges??{}).filter(d=>a.state?.inputs?.includes(d.id)||a.state?.outputs?.includes(d.id)).reduce((d,u)=>({...d,[u.id]:u}),{}));return{node:n.state,edges:i.state??{},adjacencyList:a.state??{inputs:[],outputs:[]}}},Vt=(e,t)=>we(e,o=>o?.searchResults&&o.searchResults[t]).state,To=(e,t,s)=>{g.useEffect(()=>{s()},[]);const o=Vt(e,t);return g.useEffect(()=>(o?.outdated&&s(),()=>console.warn("left search results hanging")),[o?.outdated]),o},at={name:A,version:ho,depends_on:["Store"],components:{GraphViewer:Rt},managers:{graphs:Oo},hooks:{useGraph:we,useNodeInfo:No,useSearch:To,useSearchResult:Vt},store:{selectors:{getGraphState:Go}},kernelCalls:{startModule:Do,restartModule(){},shutdownModule(){}}},Me=x(`[${k}:Theme:${y.COMMAND}] Switch theme`),Po=x(`[${k}:Theme:${y.EVENT}] Theme switched`),Lt=I();Lt.startListening({actionCreator:Me,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Po(e))}});const Oe=x(`[${k}:Ribbon:${y.COMMAND}] Add tab`),Ge=x(`[${k}:Ribbon:${y.COMMAND}] Select tab`),_o=x(`[${k}:Ribbon:${y.EVENT}] tab added`),Io=x(`[${k}:Ribbon:${y.EVENT}] tab selected`),Ne=I();Ne.startListening({actionCreator:Oe,effect:async({payload:{tab:e}},t)=>{const{dispatch:s,getState:o}=t,{Layout:{ribbonMenu:{tabs:n}}}=o();s(_o({tab:n[e.name]}))}});Ne.startListening({actionCreator:Ge,effect:async({payload:{name:e}},t)=>{const{dispatch:s,getState:o}=t,{Layout:{ribbonMenu:{tabs:n}}}=o();s(Io({tab:n[e]}))}});const Te=x(`[${k}:Viewports:${y.COMMAND}] Add viewport`),Pe=x(`[${k}:Viewports:${y.COMMAND}] Select viewport`),_e=x(`[${k}:Viewports:${y.COMMAND}] Close viewport`),Dt=x(`[${k}:Viewports:${y.COMMAND}] Rename viewport`),Ie=x(`[${k}:Viewports:${y.COMMAND}] Add viewport to group`),ke=x(`[${k}:Viewports:${y.COMMAND}] Viewport removed from group`),zo=x(`[${k}:Viewports:${y.EVENT}] Viewport added`),Uo=x(`[${k}:Viewports:${y.EVENT}] Viewport selected`),Fo=x(`[${k}:Viewports:${y.EVENT}] Viewport closed`);x(`[${k}:Viewports:${y.EVENT}] Viewport renamed`);const Bo=x(`[${k}:Viewports:${y.EVENT}] Viewport added to group`);x(`[${k}:Viewports:${y.EVENT}] Viewport removed from group`);const H=I();H.startListening({actionCreator:Te,effect:async({payload:{name:e}},t)=>{const{dispatch:s,getState:o}=t,{Layout:{viewportManager:{viewports:n}}}=o();s(zo(n[e]))}});H.startListening({actionCreator:Pe,effect:async({payload:{name:e}},t)=>{const{dispatch:s,getState:o}=t,{Layout:{viewportManager:{viewports:n}}}=o();s(Uo(n[e]))}});H.startListening({actionCreator:_e,effect:async({payload:{name:e}},t)=>{const{dispatch:s}=t;s(Fo({name:e}))}});H.startListening({actionCreator:Ie,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Bo(e))}});H.startListening({actionCreator:ke,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(ke(e))}});const ze=x(`[${k}:Viewports:${y.COMMAND}] Create group`),Wo=x(`[${k}:Viewports:${y.EVENT}] Group created`),Ot=I();Ot.startListening({actionCreator:ze,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Wo(e))}});const Ue=x(`[${k}:Panels:${y.COMMAND}] Expand settings panel`),Fe=x(`[${k}:Panels:${y.COMMAND}] Collapse settings panel`),Be=x(`[${k}:Panels:${y.COMMAND}] Open details panel`),We=x(`[${k}:Panels:${y.COMMAND}] Close details panel`),Yo=x(`[${k}:Panels:${y.EVENT}] Settings panel expanded`),qo=x(`[${k}:Panels:${y.EVENT}] Settings panel collapsed`),Ho=x(`[${k}:Panels:${y.EVENT}] Details panel opened`),Xo=x(`[${k}:Panels:${y.EVENT}] Details panel closed`),ne=I();ne.startListening({actionCreator:Ue,effect:async(e,t)=>{const{dispatch:s}=t;s(Yo())}});ne.startListening({actionCreator:Fe,effect:async(e,t)=>{const{dispatch:s}=t;s(qo())}});ne.startListening({actionCreator:Be,effect:async(e,t)=>{const{dispatch:s}=t;s(Ho())}});ne.startListening({actionCreator:We,effect:async(e,t)=>{const{dispatch:s,getState:o}=t,{Layout:{viewportManager:{activeViewport:n}}}=o();s(Xo({viewportName:n}))}});const Ko=T({name:`${k}ViewportsGroups`,initialState:{},reducers:{},extraReducers:e=>{e.addCase(ze,(t,{payload:s})=>({...t,[s.name]:{name:s.name,color:s.color}}))}}),Zo=T({name:`${k}Viewports`,initialState:{groups:{},activeViewport:"home",viewports:{}},reducers:{},extraReducers:e=>{e.addCase(Te,(t,{payload:s})=>({...t,viewports:{...t.viewports,[s.name]:s}})),e.addCase(_e,(t,{payload:s})=>({...t,activeViewport:"home",viewports:Object.entries(t.viewports).reduce((o,[n,a])=>n===s.name?o:{...o,[n]:a},{})})),e.addCase(Pe,(t,{payload:s})=>({...t,activeViewport:s.name})),e.addCase(Dt,(t,{payload:{oldName:s,newName:o}})=>({...t,viewports:Object.entries(t.viewports).reduce((n,[a,i])=>a===s?{...n,[s]:{...i,title:o}}:{...n,[a]:i},{})})),e.addCase(Ie,(t,{payload:{viewportName:s,groupName:o}})=>({...t,viewports:{...t.viewports,[s]:{...t.viewports[s],group:o}}})),e.addCase(ke,(t,{payload:{viewportName:s}})=>({...t,viewports:{...t.viewports,[s]:{...t.viewports[s],group:void 0}}})),e.addDefaultCase((t,s)=>({...t,groups:Ko.reducer(t.groups,s)}))}}),Qo=T({name:`${k}RibbonMenu`,initialState:{activeTab:"home",tabs:{}},reducers:{},extraReducers:e=>{e.addCase(Oe,(t,{payload:{tab:s}})=>{const{name:o}=s;return{...t,tabs:{...t.tabs,[o]:s}}}),e.addCase(Ge,(t,{payload:{name:s}})=>({...t,activeTab:s}))}}),Gt={settings:{state:"expanded"},details:{state:"closed"}},Jo=T({name:k,initialState:Gt,reducers:{},extraReducers:e=>{e.addCase(Ue,t=>({...t,settings:{...t.settings,state:"expanded"}})),e.addCase(Fe,t=>({...t,settings:{...t.settings,state:"collapsed"}})),e.addCase(Be,t=>({...t,details:{...t.details,state:"opened"}})),e.addCase(We,t=>({...t,details:{...t.details,state:"closed"}}))}}),en={theme:"light",ribbonMenu:{activeTab:"file",tabs:{file:{name:"file",type:"dropdown",active:!0,label:"Arquivo",loaded:!0,sectionNames:[]}}},panels:Gt,viewportManager:{activeViewport:"home",groups:{},viewports:{home:{name:"home",title:"",type:"home"}}}},tn=T({name:k,initialState:en,reducers:{},extraReducers:e=>{e.addCase(Me,(t,{payload:{theme:s}})=>({...t,theme:s})),e.addDefaultCase((t,s)=>({...t,panels:Jo.reducer(t.panels,s),ribbonMenu:Qo.reducer(t.ribbonMenu,s),viewportManager:Zo.reducer(t.viewportManager,s)}))}}),de=({name:e,icon:t,summary:s,expanded:o,state:n,children:a,sx:i,...c})=>{const d=ut("(min-width:1024px)");return n==="collapsed"?r.jsx(ls,{children:t??r.jsx(ot,{})}):r.jsxs(us,{role:`accordion-${e}`,"aria-label":`accordion ${e}`,sx:{width:"max-content",minWidth:"100%",...i},...c,children:[r.jsx(ps,{expandIcon:r.jsx(gs,{}),"aria-controls":`accordion-${e}-content`,children:r.jsxs(E,{sx:{display:"flex",overflow:"hidden",gap:2},children:[t??r.jsx(ot,{}),r.jsx(le,{component:"div",sx:{width:"33%",flexShrink:0},children:e}),s&&d&&r.jsx(le,{component:"div",sx:{color:"text.secondary"},children:s})]})}),r.jsx(fs,{children:a})]})};function Ye(){const e=V("Store"),{useAppDispatch:t}=e.hooks,s=t();return{functions:{expandSettings(){s(Ue())},collapseSettings(){s(Fe())},openDetails(){s(Be())},closeDetails(){s(We())}}}}D(e=>e.Layout,e=>e&&e.panels);const sn=D(e=>e.Layout,e=>e&&e.panels.settings),on=D(e=>e.Layout,e=>e&&e.panels.details),Nt=({title:e,display:t,children:s})=>{const o=document.getElementById(Et),n=ut("(orientation: portrait)"),a=V("Store"),{useAppSelector:i}=a.hooks,c=Ye(),d=i(on),u=g.useCallback(l=>{l.stopPropagation(),d&&d.state==="opened"&&c.functions.closeDetails()},[d?.state]);return!o||!d?null:Ee.createPortal(r.jsxs(E,{role:"details-panel","aria-label":"details panel",display:d.state==="opened"?"flex":"none",sx:{flexDirection:"column",padding:1,gap:1,minWidth:"15vw"},children:[r.jsxs(E,{role:"panel-header",sx:{display:"flex",alignItems:"center",gap:2},children:[!n&&r.jsx(B,{size:"small",component:"span",onClick:u,children:d.state==="opened"&&r.jsx(ue,{})}),r.jsx("span",{children:e??"Detalhes"})]}),r.jsx(E,{role:"panel-content",children:r.jsx(ge,{fallback:r.jsx("div",{children:"Ocorreu um erro"}),children:s})})]}),o)},Tt=({title:e,children:t})=>{const s=V("Store"),{useAppSelector:o}=s.hooks,n=Ye(),a=o(sn),i=document.getElementById(jt),c=g.useCallback(d=>{d.stopPropagation(),a&&a.state==="collapsed"&&n.functions.expandSettings(),a&&a.state==="expanded"&&n.functions.collapseSettings()},[a?.state]);return!i||!a?null:Ee.createPortal(r.jsx(E,{sx:{position:"relative"},children:r.jsxs(E,{role:"settings-panel","aria-label":"settings panel",sx:{overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},padding:1,maxWidth:a.state==="collapsed"?"6vw":"100%",display:"flex",flexDirection:"column",gap:1,"@media (orientation: portrait)":{maxWidth:a.state==="collapsed"?"8vw":"100%"}},children:[r.jsxs(E,{role:"panel-header",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.state==="expanded"&&r.jsxs(r.Fragment,{children:[r.jsx(hs,{}),r.jsx("span",{children:e??"Configurações"})]}),r.jsx(B,{size:"small",component:"span",onClick:c,children:a.state==="collapsed"?r.jsx(ms,{sx:{transform:"rotate(90deg)"}}):r.jsx(xs,{sx:{transform:"rotate(90deg)"}})})]}),r.jsx(E,{role:"panel-content",sx:{display:"flex",flexDirection:"column",placeSelf:"center",gap:a.state==="collapsed"?2:0,marginTop:4},children:r.jsx(ge,{fallback:r.jsx("div",{children:"Ocorreu um erro"}),children:t.map((d,u)=>g.cloneElement(d,{state:a.state,key:u}))})})]})}),i)},nn=({name:e,title:t,type:s,group:o})=>r.jsxs(r.Fragment,{children:[r.jsxs(Tt,{children:[r.jsx(de,{name:"Agenda",icon:r.jsx(ys,{}),expanded:!0,children:r.jsx(r.Fragment,{})}),r.jsx(de,{name:"Recebimentos",summary:"Recebimentos do mês",children:r.jsx(r.Fragment,{})}),r.jsx(de,{name:"Andamento",summary:"Pedidos em produção",children:r.jsx(r.Fragment,{})})]}),r.jsx(Nt,{children:r.jsx(r.Fragment,{children:"Detalhes"})})]}),an=N.memo(nn),rn=({dispatch:e,managers:{storeManager:t,componentRegistryManager:s}})=>{t.functions.loadReducer(k,tn.reducer),window.matchMedia("(prefers-color-scheme: dark)").matches&&e(Me({theme:"dark"})),t.functions.registerMiddleware(Lt),t.functions.registerMiddleware(Ne),t.functions.registerMiddleware(H),t.functions.registerMiddleware(Ot),t.functions.registerMiddleware(ne),s.functions.createRegistries({[De]:{},[q]:{home:an}})};function Pt(){const e=V("Store"),{useAppDispatch:t}=e.hooks,s=t();return{functions:{setTheme(o){s(Me({theme:o}))}}}}const _t=g.createContext({sections:{},setSections:()=>null}),cn=({children:e,default_sections:t})=>{const[s,o]=g.useState(t??{});function n(i,c){o({...s,[i]:c})}const a=g.useMemo(()=>({sections:s,setSections:n}),[s]);return r.jsx(_t.Provider,{value:a,children:e})},It=e=>e&&e.Layout?.ribbonMenu,zt=D(It,e=>e&&e.tabs),dn=D(It,e=>e&&e.activeTab);function Ut(){const e=V("Store"),{useAppSelector:t,useAppDispatch:s}=e.hooks,{componentRegistry:o}=e.managers,n=s(),a=t(zt);return g.useContext(_t),o(),{functions:{tabExists(i){return a!=null&&i in a},addNewTab(i){const c=pe.uniqueId("tab-"),d={...i,name:c,active:!1};n(Oe({tab:d}))},selectTab(i){n(Ge({name:i}))}}}}function Ft(){const e=V("Store"),{useAppDispatch:t}=e.hooks,{componentRegistry:s}=e.managers,o=t(),n=s();return{functions:{registerViewportTypes(a){n.functions.registerComponents({[q]:a})},getViewportTypeComponent(a){const i=n.functions.getComponent(q,a);if(!i)throw Error("Unknown viewport type");return i},addViewport(a,i,c,d="viewport"){if(!n.functions.getComponent(q,i))throw Error("Unknown viewport type");const l=pe.uniqueId(d);return o(Te({name:l,title:a,type:i,group:c})),l},renameViewport(a,i){o(Dt({oldName:a,newName:i}))},selectViewport(a){o(Pe({name:a}))},closeViewport(a){o(_e({name:a}))},createGroup(a,i){o(ze({name:a,color:i}))},addToGroup(a,i){o(Ie({viewportName:a,groupName:i}))}}}}const qe=D(e=>e.Layout.viewportManager,e=>e&&e.activeViewport),Bt=e=>e.Layout.viewportManager,ln=D(Bt,e=>e&&e.viewports),Wt=(e,t)=>{const o=t??(n=>n);return D(Bt,n=>n&&o(n.viewports[e]))},un=({children:e})=>{const t=document.getElementById(At);return t?Ee.createPortal(r.jsx(E,{sx:{position:"relative"},children:e}),t):null},pn=({title:e,component:t,children:s,sx:o={}})=>{const[n,a]=g.useState(!1),i=g.useCallback(d=>{a(!0),d.stopPropagation()},[]),c=g.useCallback(()=>{a(!1)},[]);return r.jsxs(r.Fragment,{children:[r.jsx(pt,{open:n,onClose:c,components:{Backdrop:void 0},children:r.jsxs(gt,{elevation:6,id:"modal-content",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",p:4,...o},draggable:!0,children:[e&&r.jsx(le,{variant:"subtitle1",component:"span",children:e}),N.cloneElement(t,{closeModal:c})]})}),r.jsx(E,{onClick:i,children:s})]})},He=g.createContext({rows:[],setRows:()=>null}),gn=({children:e,initialRows:t})=>{const[s,o]=g.useState((t??[]).map(a=>({...a,state:"untouched"}))),n=g.useMemo(()=>({rows:s,setRows:o}),[s]);return r.jsx(He.Provider,{value:n,children:e})},Ce=(e,t)=>t==="dark"?fe(e,.7):he(e,.7),be=(e,t)=>t==="dark"?fe(e,.6):he(e,.6),Se=(e,t)=>t==="dark"?fe(e,.5):he(e,.5),$e=(e,t)=>t==="dark"?fe(e,.4):he(e,.4),fn=ws(Ms)(({theme:e})=>({"& .state--added":{backgroundColor:Ce(e.palette.success.main,e.palette.mode),"&:hover":{backgroundColor:be(e.palette.success.main,e.palette.mode)},"&.Mui-selected":{backgroundColor:Se(e.palette.success.main,e.palette.mode),"&:hover":{backgroundColor:$e(e.palette.success.main,e.palette.mode)}}},"& .state--modified":{backgroundColor:Ce(e.palette.warning.main,e.palette.mode),"&:hover":{backgroundColor:be(e.palette.warning.main,e.palette.mode)},"&.Mui-selected":{backgroundColor:Se(e.palette.warning.main,e.palette.mode),"&:hover":{backgroundColor:$e(e.palette.warning.main,e.palette.mode)}}},"& .state--deleted":{backgroundColor:Ce(e.palette.error.main,e.palette.mode),"&:hover":{backgroundColor:be(e.palette.error.main,e.palette.mode)},"&.Mui-selected":{backgroundColor:Se(e.palette.error.main,e.palette.mode),"&:hover":{backgroundColor:$e(e.palette.error.main,e.palette.mode)}}}})),hn=()=>r.jsx(E,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:r.jsx(le,{variant:"body2",children:"Sem registros"})}),mn=({handleAddRecord:e,addLabel:t})=>r.jsxs(ks,{sx:{display:"flex",justifyContent:"space-around"},children:[r.jsx(js,{startIcon:r.jsx(Es,{}),onPointerUp:e,children:t||"Adicionar"}),r.jsx("div",{children:r.jsx(As,{})})]}),xn=({columns:e,addLabel:t,newRecord:s,...o})=>{const{rows:n,setRows:a}=g.useContext(He),[i,c]=g.useState({}),d=()=>{const f=s();a(M=>[...M,{...f,state:"added"}]),c(M=>({...M,[f.id]:{mode:Z.Edit,fieldToFocus:"id"}}))},u=g.useCallback(f=>()=>{c(M=>({...M,[f]:{mode:Z.Edit}}))},[]),l=f=>(a(M=>M.map(b=>b.id===f.id?{...f,old:{...b,old:null}}:b)),f),p=(f,M)=>{f.reason===Rs.rowFocusOut&&(M.defaultMuiPrevented=!0)},m=g.useCallback(f=>{const M=n.find(S=>S.id===f);if(!M)return;const b=M.state==="untouched"?"modified":M.state;a(S=>S.map(R=>R.id===f?{...R,state:b}:R)),c(S=>({...S,[f]:{mode:Z.View}}))},[n]),C=g.useCallback(f=>()=>{a(M=>M.map(b=>b.id===f?{...b,state:"deleted",oldState:b.state}:b).filter(b=>!(b.state==="deleted"&&b?.oldState==="added")))},[]),$=g.useCallback(f=>()=>{a(M=>M.map(b=>b.id===f?{...b,state:b.oldState,oldState:"deleted"}:b))},[]),h=g.useCallback(f=>()=>{c(b=>({...b,[f]:{mode:Z.View,ignoreModifications:!0}}));const M=n.find(b=>b.id===f);M&&M.state==="added"&&a(b=>b.filter(S=>S.id!==f))},[n]);return r.jsx(r.Fragment,{children:r.jsx(fn,{editMode:"row",hideFooter:!0,autoHeight:!0,rowModesModel:i,getRowClassName:f=>`state--${f.row.state}`,onRowEditStop:p,processRowUpdate:l,slotProps:{toolbar:{handleAddRecord:d,addLabel:t}},slots:{noRowsOverlay:hn,toolbar:mn},columns:[...e,{field:"actions",type:"actions",headerName:"Actions",cellClassName:"actions",getActions:({id:f})=>{const M=n.find(S=>S.id===f);return M?i[f]?.mode===Z.Edit?[r.jsx(Q,{icon:r.jsx(Cs,{}),label:"Save",id:`save-${f}`,sx:{color:"primary.main"},onClick:()=>m(f)},"save"),r.jsx(Q,{icon:r.jsx(bs,{}),label:"Cancel",className:"textPrimary",onClick:h(f),color:"inherit"},"cancel")]:M.state==="deleted"?[r.jsx(Q,{icon:r.jsx(Ss,{}),label:"Restore",className:"textPrimary",onClick:$(f),color:"inherit"},"restore")]:[r.jsx(Q,{icon:r.jsx($s,{}),label:"Edit",className:"textPrimary",onClick:u(f),color:"inherit"},"edit"),r.jsx(Q,{icon:r.jsx(vs,{}),label:"Delete",onClick:C(f),color:"inherit"},"delete")]:[]}}],...o,rows:n})})};function yn({id:e,value:t,field:s}){const o=Vs(),n=a=>{const i=a.target.checked;o.current.setEditCellValue({id:e,field:s,value:i})};return r.jsx(Ls,{checked:t,onChange:n})}const wn=e=>{const[t,s]=g.useState();return g.useLayoutEffect(()=>{if(!e.current)return;const o=e.current,n=new ResizeObserver(a=>{a.forEach(i=>{s(i.contentRect)})});return n.observe(o),()=>n.unobserve(o)},[e]),t},Yt={name:k,version:Ao,depends_on:[],components:{SettingsPanel:Tt,DetailsPanel:Nt,ViewportNotificationsTray:un,Accordion:de,SystemModal:pn,CRUDGrid:xn,CRUDBooleanCell:yn,CRUDGridProvider:gn},contexts:{CRUDGridContext:He},hooks:{useLayoutManager:Pt,useRibbonMenuManager:Ut,useViewportManager:Ft,usePanelsManager:Ye,useResizeObserver:wn},store:{selectors:{selectActiveViewport:qe,getViewportState:Wt}},kernelCalls:{startModule:rn,restartModule(){},shutdownModule(){}}},ae="Loader",Mn="0.0.1",ee="modules",qt=x(`[${ae}:${y.EVENT}] Module started`),Cn=x(`[${ae}:${y.COMMAND}] Start module`),bn={modulesCount:1,modulesGraph:ee},Sn=T({name:ae,initialState:bn,reducers:{},extraReducers:e=>{e.addCase(qt,t=>(t.modulesCount+=1,t))}}),$n=({managers:{storeManager:e}})=>{e.functions.loadReducer(ae,Sn.reducer)};class rt extends Error{}class vn extends Error{}const kn=e=>e.modulesCount,jn=()=>{const{modules:e,setModules:t}=g.useContext(Ae),{useLayoutManager:s,useRibbonMenuManager:o,useViewportManager:n}=Yt.hooks,{store:a,componentRegistry:i}=ce.managers,c=s(),d=o(),u=n(),l=a(),p=i(),m=ce.hooks.useAppDispatch(),C=ce.hooks.useAppSelector;return{modulesLoaded:C(kn),functions:{isModuleLoaded:f=>f in e,loadModule(f){if(f.name in e)throw new vn(`${f.name} is not registered. Consider using restartModule instead.`);t({...e,[f.name]:f}),m(Cn(f.name)),f.kernelCalls.startModule({dispatch:m,managers:{storeManager:l,componentRegistryManager:p,layoutManager:c,ribbonMenuManager:d,viewportManager:u}}),m(qt(f.name))},unloadModule(f){if(!(f in e))throw new rt(`${f} is not registered.`);e[f].kernelCalls.shutdownModule(l),delete e[f],t(e)},reloadModule(f){if(!(f in e))throw new rt(`${f} is not registered.`);const M=e[f];t(e),M.kernelCalls.restartModule(l)}}}},it={name:ae,version:Mn,depends_on:["Store","Graph"],managers:{modules:jn},kernelCalls:{startModule:$n,restartModule:()=>null,shutdownModule:()=>null}},En=({afterLoadComponent:e,extraModules:t={kernel:[],system:[]}})=>{const s=it.managers.modules(),o=we(ee,v=>v&&v.id),[n,a]=g.useState(!0),[i,c]=g.useState(!1),[d,u]=g.useState(0),[l,p]=g.useState(0),[m,C]=g.useState(0),$=g.useMemo(()=>[it,at,Yt],[]),h=at.managers.graphs(),{createGraph:f,resetGraph:M}=h.functions;g.useEffect(()=>{const v=$[d];v&&!s.functions.isModuleLoaded(v.name)&&b(v)},[d]),g.useEffect(()=>{if(d===$.length){const v=t.kernel[l];v&&!s.functions.isModuleLoaded(v.name)&&S(v)}},[d,l]),g.useEffect(()=>{if(l===t.kernel.length){const v=t.system[m];v&&!s.functions.isModuleLoaded(v.name)&&R(v)}},[l,m]),g.useEffect(()=>{m===t.system.length&&a(!1)},[m]),g.useEffect(()=>{!n&&!o.state&&(f(ee),c(!0))},[n]),g.useEffect(()=>{if(i&&!o.state&&f(ee),!i)return;M(ee);const v={id:"root",type:"ROOT"};o.actions.addNode(v),$.forEach(w=>o.actions.addNode({id:w.name,type:"STATIC_MODULE"},{inputs:{root:{id:`root->${w.name}`,type:"DEPENDS_ON",sourceId:"root",targetId:w.name}},outputs:{}})),t.kernel.forEach(w=>{w.depends_on.push("Loader");const G=w.depends_on.reduce((Y,_)=>{const X={id:`${_}->${w.name}`,type:"DEPENDS_ON",sourceId:_,targedId:w.name};return{...Y,[_]:X}},{});o.actions.addNode({id:w.name,type:"EXTRA_KERNEL_MODULE"},{inputs:G,outputs:{}})}),t.system.forEach(w=>{w.depends_on.push("Loader");const G=w.depends_on.reduce((Y,_)=>{const X={id:`${_}->${w.name}`,type:"DEPENDS_ON",sourceId:_,targedId:w.name};return{...Y,[_]:X}},{});o.actions.addNode({id:w.name,type:"EXTRA_SYSTEM_MODULE"},{inputs:G,outputs:{}})}),a(!1)},[i]);function b(v){s.functions.loadModule(v),u(d+1)}function S(v){s.functions.loadModule(v),p(l+1)}function R(v){s.functions.loadModule(v),C(m+1)}return n?r.jsx("div",{children:"Iniciando sistema"}):e},An=({children:e,loadModules:t})=>{const[s,o]=g.useState({Store:ce}),n=g.useMemo(()=>({modules:s,setModules:o}),[s]);return r.jsx(Ae.Provider,{value:n,children:r.jsx(En,{extraModules:t,afterLoadComponent:e})})},Ea=N.memo(An),Rn={},ie=T({name:mt,initialState:Rn,reducers:{},extraReducers:e=>{}}),Vn=({children:e,default_registries:t})=>{const[s,o]=g.useState(t??{}),n=g.useMemo(()=>({registries:s,createRegistry:a,createRegistries:i,getComponent:c,registerComponents:d}),[s]);function a(u){o({...s,[u]:{}})}function i(u){o({...s,...u})}function c(u,l){return s[u][l]}function d(u){const l=s,p=Object.entries(u).reduce((m,[C,$])=>C in m?{...m,[C]:{...m[C],...$}}:m,l);o(p)}return r.jsx(wt.Provider,{value:n,children:e})},Ln=({children:e})=>{const[t,s]=g.useState({[ie.name]:ie.reducer}),o=g.useMemo(()=>Ds({reducer:nt({[ie.name]:ie.reducer}),middleware:i=>i({serializableCheck:!1}).concat(Os)}),[]),n=i=>{Ns(i.middleware)},a=g.useCallback(i=>{const c={...t,...i};s(c),o.replaceReducer(nt(c))},[t]);return r.jsx(Gs,{store:o,children:r.jsx(xt.Provider,{value:{currentReducers:t,loadReducers:a,registerMiddleware:n},children:r.jsx(Vn,{children:e})})})},Aa=N.memo(Ln),Ht=D(e=>e.Layout,e=>e&&e.theme),Dn=({systemTray:e})=>{const t=V("Store"),{useAppSelector:s}=t.hooks,{componentRegistry:o}=t.managers,n=o(),a=Ut(),{selectTab:i}=a.functions,c=s(zt),d=s(dn),u=g.useCallback(l=>{i(l)},[]);return!d||!c?r.jsx(r.Fragment,{}):r.jsxs(Ts,{value:d,children:[r.jsxs(E,{sx:{display:"flex",justifyContent:"space-between"},role:"ribbon-menu-tabs","aria-label":"ribbon menu tabs",children:[r.jsx(ft,{value:d,"aria-label":"ribbon menu tabs",role:"ribbon-menu-tabs",textColor:"secondary",indicatorColor:"secondary",children:Object.entries(c).map(([l,p])=>r.jsx(J,{value:l,label:p.label,id:l,onClick:()=>u(l),wrapped:!0},l))}),r.jsx(E,{role:"system-tray","aria-label":"system tray",sx:{display:"flex",p:1,alignItems:"center"},children:e})]}),r.jsx(E,{role:"ribbon-menu-panels","aria-label":"ribbon menu panels",sx:{borderBottom:1,borderColor:"divider",minHeight:"10vh"},children:c&&Object.entries(c).map(([l,p])=>r.jsx(Ps,{value:l,children:p.sectionNames&&p.sectionNames.map(m=>{const C=n.functions.getComponent(De,m);return g.createElement(C,{key:`ribbon-panel-${l}-section-${m}`},[])})},`ribbon-panel-${l}`))})]})},On=({children:e,...t})=>{const s=g.useMemo(()=>({file:[r.jsx("div",{children:"test"},"test")]}),[]);return r.jsx(cn,{default_sections:s,children:r.jsx(Dn,{...t,systemTray:e})})},Gn=N.memo(On),Nn=()=>{const e=V("Store"),{useAppSelector:t}=e.hooks,s=e.managers.componentRegistry(),o=t(qe),n=t(Wt(o));if(!n)return null;const a=s.functions.getComponent(q,n.type);return a?r.jsx(ge,{fallback:r.jsx("div",{children:"Ocorreu um erro"}),children:N.createElement(a,n,[])}):null},Tn=D(e=>e.Layout.viewportManager,e=>e&&e.groups),Pn=({sx:e,...t})=>{const s=V("Store"),{useAppSelector:o}=s.hooks,n=o(Tn),a=o(qe),i=o(ln),c=g.useMemo(()=>Object.entries(i).reduce((C,[$,h])=>$==="home"?C:h.group?{...C,[h.group]:h.group in C?[...C[h.group],h]:[h]}:{...C,notGrouped:[...C.notGrouped,h]},{notGrouped:[]}),[i]),{functions:{addViewport:d,closeViewport:u,selectViewport:l}}=Ft(),p=g.useCallback(()=>{d("Nova aba","home",void 0,"new-")},[]),m=g.useCallback(C=>{u(C)},[]);return r.jsxs(E,{role:"viewport-manager",sx:{...e,height:"100%",display:"flex",flexDirection:"column"},...t,children:[r.jsxs(E,{sx:{display:"flex",justifyContent:"space-between"},children:[r.jsxs(ft,{value:a,"aria-label":"viewport tabs",role:"viewport-tabs",sx:{maxWidth:"100%"},children:[r.jsx(J,{value:"home",icon:r.jsx(_s,{}),iconPosition:"start",onClick:()=>l("home"),id:"home",sx:{width:"fit-content",minWidth:0,p:1}},"home"),Object.entries(c).map(([C,$])=>C==="notGrouped"?$.map(h=>r.jsx(J,{value:h.name,id:h.name,sx:{width:"fit-content",p:1},onClick:f=>f.button!=2?l(h.name):m(h.name),label:r.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsx("span",{children:h.title}),r.jsx(ue,{sx:{width:.3,marginLeft:1,alignItems:"center"},onClick:f=>{f.stopPropagation(),m(h.name)}})]}),draggable:!0,wrapped:!0},`${h.name}-tab`)):$.map(h=>r.jsx(J,{value:h.name,id:h.name,sx:{width:"fit-content",p:1,borderTop:2,borderColor:n[h.group].color},onClick:()=>l(h.name),label:r.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsx("span",{children:h.title}),r.jsx(B,{size:"small",component:"span",children:r.jsx(ue,{sx:{width:.5,marginLeft:1},onClick:f=>{f.stopPropagation(),m(h.name)}})})]}),draggable:"true",wrapped:!0},`${h.name}-tab`))),r.jsx(J,{value:"new",icon:r.jsx(Is,{}),iconPosition:"start",role:"add viewport","aria-label":"Add viewport",id:"new-viewport",onClick:p,sx:{width:"fit-content",minWidth:0,p:1}},"new")]}),r.jsx(E,{id:At,role:"viewport-notifications","aria-label":"viewport notifications",sx:{display:"flex",p:1,gap:2,alignItems:"center"}})]}),r.jsx(E,{role:"viewport-content","aria-label":"viewport content",sx:{width:"100%",flexGrow:1,overflow:"auto"},children:r.jsx(Nn,{})})]})},_n=N.memo(Pn),In=()=>{const e=V("Store"),{useAppSelector:t}=e.hooks,s=t(Ht),o=Pt(),n=g.useCallback(()=>{o.functions.setTheme(s=="dark"?"light":"dark")},[s]);return r.jsx(E,{role:"system-tray-container",children:r.jsx(B,{color:"primary","aria-label":"switch theme button",onClick:n,children:s==="light"?r.jsx(zs,{fontSize:"small"}):r.jsx(Us,{fontSize:"small"})})})},zn=N.memo(In),Un=Fs(E)`
  display: grid;
  height: 100vh;

  grid-template-rows: min-content auto;
  grid-template-areas:
    "ribbon ribbon ribbon"
    "settings viewport details";

  @media (orientation: portrait) {
    grid-template-rows: auto 2fr minmax(10px, 2fr);
    grid-template-areas:
      "ribbon ribbon"
      "viewport viewport"
      "settings details";
  }
`,Fn=()=>{const e=V("Store"),{useAppSelector:t}=e.hooks,s=t(Ht),o=g.useMemo(()=>Bs({palette:{mode:s??"dark",contrastThreshold:3,tonalOffset:.2},typography:{fontSize:12,fontFamily:"Raleway, Arial"}}),[s]);return r.jsxs(Ws,{theme:o,children:[r.jsx(Ys,{}),r.jsx(E,{role:"layout-root",sx:{minHeight:"100vh"},children:r.jsxs(Un,{role:"content",sx:{gridTemplateColumns:"auto minmax(auto, 4fr) auto"},children:[r.jsx(E,{sx:{gridArea:"ribbon",width:"100%"},children:r.jsx(Gn,{children:r.jsx(zn,{})})}),r.jsx(E,{id:jt,role:"settings-panel-container",sx:{gridArea:"settings",minHeight:"100%",borderTop:0,borderRight:1,borderColor:"divider",overflow:"auto","@media (orientation: portrait)":{borderTop:1,borderColor:"divider"}}}),r.jsx(_n,{sx:{gridArea:"viewport",position:"relative",overflow:"auto","&::-webkit-scrollbar":{width:"0.4em"}}}),r.jsx(E,{id:Et,role:"details-panel-container",sx:{gridArea:"details",width:"100%",borderLeft:1,borderColor:"divider",overflow:"auto","@media (orientation: portrait)":{borderLeft:0,borderTop:1,borderColor:"divider"}}})]})})]})},Ra=N.memo(Fn),Bn=({dataTransform:e})=>(t,s,o)=>{const{matrix:i,names:c}=e(o),d=ht().innerRadius(200).outerRadius(210),l=qs().padAngle(5/200).sortSubgroups(Hs)(i),p=Xs(Ks,c.length+1),m=Zs().radius(200-1).padAngle(1/200),C=s.append("g").attr("id","chord-plot"),$=C.append("g").attr("role","groups-container"),h=C.append("g").attr("role","chords-container").attr("fill-opacity",.75),f=$.selectAll().data(l.groups).join("g").attr("id",M=>c[M.index]);f.append("path").attr("fill",M=>p[M.index]).attr("d",d),f.append("text").attr("dy","0.35em").attr("transform",M=>`
        rotate(${(M.startAngle+M.endAngle)/2*180/Math.PI-90})
        translate(${210+5})
        ${(M.startAngle+M.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",M=>(M.startAngle+M.endAngle)/2>Math.PI?"end":null).text(M=>c[M.index]).attr("fill","white"),h.selectAll().data(l).join("path").style("mix-blend-mode","add").attr("fill",M=>p[M.target.index]).attr("d",m).append("title").text(M=>`${c[M.source.index]} → ${c[M.target.index]} ${M.source.value}`)},Wn=({xSettings:e,ySettings:t,dimensions:[s,o]})=>{const n=te().domain(e.domain).range(e.range),a=te().domain(t.domain).range(t.range),i=ct(n).ticks((s+2)/(o+2)*10).tickSize(o).tickPadding(8-o),c=dt(a).ticks(10).tickSize(s).tickPadding(8-s);let d=(l,p)=>{};function u(l,p,m){const C=p.selectAll("g").data([1]).join("g").attr("role","grid"),$=l.select("#content"),h=l.select("#overlays"),f=C.append("g").attr("class","axis axis--x").attr("stroke-opacity","0.3").attr("stroke-dasharray","6 1").attr("stroke-width","0.5px").call(i),M=C.append("g").attr("class","axis axis--y").attr("stroke-opacity","0.3").attr("stroke-dasharray","6 1").attr("stroke-width","0.5px").call(c),b=lt().scaleExtent([-10,40]).filter(S=>(S.preventDefault(),(!S.ctrlKey||S.type==="wheel")&&!S.button)).on("zoom",({transform:S})=>{$.attr("transform",S),h.attr("transform",S),f.call(i.scale(S.rescaleX(n))),M.call(c.scale(S.rescaleY(a)))});d(l,b),l.call(b)}return u.transformZoom=l=>(d=l,u),u.build=u,u},Yn=e=>e.SVG,qn=e=>D(Yn,t=>t&&t.svgs[e]),Hn=({path:e,instanceName:t,beforeInjection:s,sx:o,...n})=>{const a=V("Store"),{useAppSelector:i}=a.hooks,c=i(qn(e)),d=g.useCallback(l=>{if(l.setAttribute("id",`${e}-root`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),t){if(!c?.instances[t])return;Object.entries(c?.instances[t].proxies??{}).forEach(([m,C])=>{const $=l.getElementById(m);$&&("fill"in C&&$.setAttribute("fill",C.fill),"stroke"in C&&$.setAttribute("stroke",C.stroke))})}s&&s(l)},[s,c?.content,t,c?.instances[t]]),u=g.useMemo(()=>c?.content&&window.URL.createObjectURL(new Blob([c.content],{type:"image/svg+xml"})),[c?.content]);return!c||!u?null:r.jsx(E,{...n,role:"svg-viewport",id:e,"aria-label":"SVG viewer",sx:{...o,width:"100%",display:"flex",alignItems:"top",justifyContent:"center"},children:r.jsx(Qs,{style:{width:"100%",overflow:"hidden"},src:u,height:"100%",width:"100%",beforeInjection:d})})},O="SVG",Xn="0.0.1";function Kn(){let e=700,t=700,s=[],o=[],n=[];function a(c){c.each(d=>{c.attr("viewBox",[0,0,e,t]);const u=c.selectAll("#underlays").data([1]).join("g").attr("id","underlays"),l=c.selectAll("#content").data([1]).join("g").attr("id","content"),p=c.selectAll("#overlays").data([1]).join("g").attr("id","overlays");s.forEach(m=>m(c,u,d)),o.forEach(m=>m(c,l,d)),n.forEach(m=>m(c,p,d))})}function i(c,d){je(d).datum(c).call(a)}return i.width=c=>c?(e=c,i):e,i.height=c=>c?(t=c,i):t,i.underlays=c=>c?(s=c,i):s,i.content=c=>c?(o=c,i):o,i.overlays=c=>c?(n=c,i):n,i.render=i,i}const Xe=x(`[${O}:SVG:${y.COMMAND}] Load SVG`),Xt=x(`[${O}:SVG:${y.COMMAND}] Fetch SVG`),Kt=x(`[${O}:SVG:${y.COMMAND}] Set pan`),Zt=x(`[${O}:SVG:${y.COMMAND}] Set zoom`),Qt=x(`[${O}:SVG:${y.COMMAND}] Add proxy`),Ke=x(`[${O}:SVG:${y.COMMAND}] Update proxy`),Ze=x(`[${O}:SVG:${y.COMMAND}] Delete proxy`),Qe=x(`[${O}:SVG:${y.EVENT}] SVG fetched`),Zn=x(`[${O}:SVG:${y.EVENT}] SVG loaded`);x(`[${O}:SVG:${y.COMMAND}] Proxy added`);const Qn=x(`[${O}:SVG:${y.COMMAND}] Proxy updated`),Jn=x(`[${O}:SVG:${y.COMMAND}] Proxy deleted`),ea=(e,t)=>{const s=V("Store"),{useAppDispatch:o}=s.hooks,n=o(),a=s.hooks.useAppSelector,i=D(d=>d&&d.SVG.svgs[e],t);return{state:a(i),actions:{setPan(d,u,l){n(Kt({path:e,instanceName:d,x:u*-10,y:l*-10}))},setZoom(d,u){n(Zt({path:e,instanceName:d,zoom:u}))},addProxy(d,u,l){n(Qt({path:e,instanceName:u,id:d,styles:l}))},deleteProxy(d,u){n(Ze({path:e,instanceName:u,id:d}))},updateProxy(d,u,l){n(Ke({path:e,instanceName:u,id:d,changes:l}))}}}},ta=()=>{const e=V("Store"),{useAppDispatch:t}=e.hooks,s=t();return{functions:{loadSVG(o,n){s(Xe({path:o,instanceName:n}))}}}},re=I();re.startListening({actionCreator:Xe,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Xt({path:e.path}));const n=await(await(await fetch(e.path)).blob()).text();s(Qe({path:e.path,content:n}))}});re.startListening({actionCreator:Qe,effect:async({payload:e},t)=>{const{dispatch:s,getState:o}=t,{SVG:{svgs:n}}=o();s(Zn(n[e.path]))}});re.startListening({actionCreator:Ke,effect:async({payload:e},t)=>{const{dispatch:s,getState:o}=t,{SVG:{svgs:n}}=o();s(Qn(n[e.path].instances[e.instanceName].proxies))}});re.startListening({actionCreator:Ze,effect:async({payload:e},{dispatch:t})=>{t(Jn(e))}});const sa={progress:"not-started",instances:{},content:void 0},oa={svgs:{}},na=T({name:O,initialState:oa,reducers:{},extraReducers:e=>{e.addCase(Xe,(t,{payload:{path:s,instanceName:o}})=>{let n={[o]:{zoom:1,pan:[500,500],proxies:{}}};return t.svgs[s]&&!pe.isEmpty(t.svgs[s].instances)&&(n={...n,...t.svgs[s].instances}),{...t,svgs:{[s]:{path:s,...sa,instances:n}}}}),e.addCase(Xt,(t,{payload:{path:s}})=>({...t,svgs:{[s]:{...t.svgs[s],progress:"started"}}})),e.addCase(Qe,(t,{payload:{path:s,content:o}})=>({...t,svgs:{...t.svgs,[s]:{...t.svgs[s],progress:"completed",content:o}}})),e.addCase(Qt,(t,{payload:{path:s,instanceName:o,id:n,styles:a}})=>({...t,svgs:{[s]:{...t.svgs[s],instances:{...t.svgs[s].instances,[o]:{...t.svgs[s].instances[o],proxies:t.svgs[s].instances[o]?{...t.svgs[s].instances[o].proxies,[n]:a}:{[n]:a}}}}}})),e.addCase(Zt,(t,{payload:{path:s,instanceName:o,zoom:n}})=>({...t,svgs:{[s]:{...t.svgs[s],instances:{...t.svgs[s].instances,[o]:{...t.svgs[s].instances[o],zoom:n}}}}})),e.addCase(Kt,(t,{payload:{path:s,instanceName:o,x:n,y:a}})=>({...t,svgs:{[s]:{...t.svgs[s],instances:{...t.svgs[s].instances,[o]:{...t.svgs[s].instances[o],pan:[n,a]}}}}})),e.addCase(Ke,(t,{payload:{path:s,instanceName:o,id:n,changes:a}})=>({...t,svgs:{[s]:{...t.svgs[s],instances:{...t.svgs[s].instances,[o]:{...t.svgs[s].instances[o],proxies:{...t.svgs[s].instances[o].proxies,[n]:t.svgs[s].instances[o].proxies?{...t.svgs[s].instances[o].proxies[n],...a}:a}}}}}})),e.addCase(Ze,(t,{payload:{path:s,instanceName:o,id:n}})=>({...t,svgs:{[s]:{...t.svgs[s],instances:{...t.svgs[s].instances,[o]:{...t.svgs[s].instances[o],proxies:Object.entries(t.svgs[s].instances[o].proxies).reduce((a,[i,c])=>i===n?a:{...a,[i]:c},{})}}}}}))}}),aa=({managers:{storeManager:e,componentRegistryManager:t}})=>{e.functions.loadReducer(O,na.reducer),e.functions.registerMiddleware(re)},ra=()=>{let e=50,t=52,s="group",o=p=>p,n="dark",a=p=>!!p,i=p=>!!p,c=(p,m,C)=>{p.append("text").text($=>$.nodeLabel).attr("fill",$=>C($.group)).attr("text-anchor","middle")},d=(p,m,C,$,h,f,M)=>{p.selectAll("path").data([m]).join("path").attr("class","group-arc").attr("fill",b=>$(m.name)).attr("d",(b,S)=>h(C)),p.selectAll("text").data([m]).join("text").attr("class","group-text").text(b=>b.name).attr("fill",b=>$(b.name)).attr("text-anchor",(b,S)=>(C.endAngle+C.startAngle)/2>Math.PI?"end":"start").attr("transform",(b,S)=>{const[R,v]=h.centroid(C),w=Math.sqrt(R*R+v*v);return`translate(${R/w*e*1.3}, ${v/w*e*1.3})`})},u=(p,m,C)=>{const $=oo().curve(no.beta(.35));p.append("path").attr("data-source",h=>h.source).attr("data-target",h=>h.target).attr("d",h=>$([[(e-10)*Math.sin(m(h.sourceOffset)),(e-10)*-Math.cos(m(h.sourceOffset))],[0,0],[(e-10)*Math.sin(m(h.targetOffset)),(e-10)*-Math.cos(m(h.targetOffset))]])).attr("fill","none").attr("stroke-width",5).attr("stroke","url(#convertion-gradient)")};function l(p,m,C){p.selectAll("defs").data([1]).join(j=>{let L=j.append("defs").append("linearGradient").attr("id","convertion-gradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","0%");const P=[{color:"steelblue",offset:"0%"},{color:"red",offset:"100%"}];return L.selectAll("stop").data(P).join("stop").attr("stop-color",U=>U.color).attr("offset",U=>U.offset),L});const $=m.selectAll(".dependency-circle").data([1]).join("g").attr("class","dependency-circle"),h=o(C),f=h.nodes.filter(a);f.sort((j,L)=>j.group>=L.group?-1:1);const M=h.links.filter(i),b=f.reduce((j,L,P)=>L.group in j?{...j,[L.group]:[...j[L.group],{...L,idx:P,offset:0}]}:{...j,[L.group]:[{...L,idx:P,offset:0}]},{}),S=Object.entries(b).map(([j,L])=>({name:j,nodes:L,size:L.length})),R=Js().domain(Object.keys(b)).range(eo),v=te().domain([0,f.length]).range([0,2*Math.PI]),w=to(),G=S.map(({size:j})=>j),Y=w(G),_=ht().innerRadius(e*1.1).outerRadius(e*1.2).startAngle(j=>j.startAngle).endAngle(j=>j.endAngle),X=$.selectAll(".links").data([1]).join("g").attr("class","links");$.selectAll(".groups").data([1]).join("g").attr("class","groups").selectAll(".group").data(S).join("g").attr("id",j=>j.name).attr("class","group"),Y.forEach((j,L)=>{const P=so.sum(Y.filter((F,K)=>F.index<j.index).map(F=>F.value)),U=S[L];je(`#${U.name}`).call(d,U,j,R,_,e,t).selectAll(".nodes-container").data([U]).join("g").attr("class","nodes-container").selectAll(".node").data(U.nodes).join("g").attr("class","node").attr("id",F=>F.id).attr("data-offset",(F,K)=>P+K).attr("transform",(F,K)=>`translate(${e*Math.sin(v(P+K))}, ${e*-Math.cos(v(P+K))}) `).call(c,v,R)}),X.selectAll(".link").data(M.map(j=>{const L=$.select(`#${j.source}`),P=$.select(`#${j.target}`);return{...j,sourceOffset:+L.attr("data-offset"),targetOffset:+P.attr("data-offset")}})).join("g",j=>(j.select("*").remove(),j),j=>j.remove()).attr("class","link").attr("id",j=>j.id).call(u,v,R)}return l.innerRadius=p=>p?(e=p,l):e,l.groupBy=p=>p?(s=p,l):s,l.graph=p=>p?(o=p,l):o,l.theme=p=>p?(n=p,l):n,l.renderNode=p=>(c=p,l),l.renderLink=p=>(u=p,l),l.renderGroup=p=>(d=p,l),l.filterNode=p=>(a=p,l),l.filterLink=p=>(i=p,l),l.build=l,l},Va={name:O,version:Xn,depends_on:[],components:{SVGViewer:Hn},d3Components:{Grid:Wn,ChordPlot:Bn,DependencyCircle:ra},hooks:{useD3Container:Kn,useSVGManager:ta,useSVG:ea},kernelCalls:{startModule:aa,restartModule(){},shutdownModule(){}}},ia=({initialPosition:e})=>{const[t,s]=g.useState(!1),[o,n]=g.useState({x:0,y:0}),[a,i]=g.useState(e),c=g.useCallback(l=>{s(!0),n({x:l.clientX,y:l.clientY}),l.stopPropagation()},[]),d=g.useCallback(l=>{if(!t)return;const p={x:l.clientX-o.x,y:l.clientY-o.y},m={x:a.x+p.x,y:a.y+p.y};i(m)},[t]),u=g.useCallback(l=>{s(!1),l.stopPropagation()},[]);return{position:a,setPosition:i,listeners:{onPointerDown:c,onPointerMove:d,onPointerUp:u}}},ca=({children:e,component:t,actions:s,onClose:o})=>{const[n,a]=g.useState(!1),[i,c]=g.useState(!0),{innerWidth:d,innerHeight:u}=window,l=[d/2,u/2],{position:p,setPosition:m,listeners:C}=ia({initialPosition:{x:l[0],y:l[1]}}),$=g.useCallback((S,R)=>{const v=S-l[0],w=R-l[1];return v<0?w<0?1:3:w<0?2:4},[l]),h=g.useMemo(()=>$(p.x,p.y),[p]),f=g.useRef(null);g.useEffect(()=>{if(n&&i&&f.current){const{clientWidth:S,clientHeight:R}=f.current;h%2==0?m(v=>({x:v.x-S,y:v.y-R})):h>2&&m(v=>({x:v.x,y:v.y-R})),c(!1)}n||c(!0)},[n,f.current]);const M=g.useCallback(S=>{a(!0),m({x:S.clientX,y:S.clientY}),S.stopPropagation()},[]),b=g.useCallback(S=>{a(!1),S.stopPropagation(),o?.(S)},[]);return r.jsxs(r.Fragment,{children:[r.jsx(pt,{open:n,keepMounted:!0,onClose:b,disableEnforceFocus:!0,role:"pointer-panel",sx:{width:"min-content",touchAction:"none"},slotProps:{backdrop:{}},slots:{backdrop:()=>null},...C,children:r.jsx(gt,{sx:{position:"fixed",margin:1,left:p.x,top:p.y},elevation:6,children:r.jsxs(E,{ref:f,sx:{display:"flex",flexGrow:1,flexDirection:h%2==1?"row":"row-reverse"},children:[r.jsxs(E,{role:"pointer-panel-actions",sx:{display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignContent:"space-between",borderLeft:`1px solid rgba(0,0,0, ${h%2==1?0:.1})`,borderRight:`1px solid rgba(0,0,0, ${h%2==1?.1:0})`},children:[r.jsx(B,{sx:{cursor:"grab"},size:"small",id:"drag-panel",children:r.jsx(ao,{})}),s.map(S=>g.cloneElement(S,{size:"small",closeContainer:b})),r.jsx(B,{color:"error",onClick:b,size:"small",id:"close-panel",children:r.jsx(ue,{})},"reject")]}),r.jsx(E,{role:"pointer-panel-content",sx:{padding:1,display:"flex",justifyContent:"center",alignContent:"center"},children:r.jsx(ge,{fallback:r.jsx("div",{children:"Ocorreu um erro"}),children:N.cloneElement(t,{isOpen:n})})})]})})}),g.cloneElement(e,{onClick:M})]})},da=({gestures:e,children:t})=>{const s=g.useRef(null),n=ro(e,{drag:{filterTaps:!0,triggerAllEvents:!0}})();return r.jsx(E,{role:"multi-touch-panel",ref:s,...n,sx:{position:"relative",touchAction:"none"},children:t})},Je="Pointer",la="0.0.1",ua={},pa=T({name:Je,initialState:ua,reducers:{},extraReducers:e=>{}}),ga=({managers:{storeManager:e,componentRegistryManager:t}})=>{console.group("Starting pointer module"),e.functions.loadReducer(Je,pa.reducer),console.info("Pointer module started"),console.groupEnd()},fa=({closeContainer:e,handleConfirm:t,...s})=>g.createElement(B,{...s,color:"success",key:"accept",onClick:o=>{t(),e&&e(o)}},r.jsx(io,{})),La={name:Je,version:la,depends_on:[],components:{MultiTouchPanel:da,PointerContainer:ca,ConfirmAndCloseButton:fa},hooks:{},store:{},kernelCalls:{startModule:ga,restartModule(){},shutdownModule(){}}},W="Markdown",ha="0.0.1",et=x(`[${W}:SVG:${y.COMMAND}] Load Markdown`),Jt=x(`[${W}:SVG:${y.COMMAND}] Fetch Markdown`),tt=x(`[${W}:SVG:${y.EVENT}] Markdown fetched`),es=x(`[${W}:SVG:${y.EVENT}] Markdown loaded`),ma=()=>{const e=V("Store"),{hooks:{useAppDispatch:t}}=e,s=t();return{loadMarkdown(o){s(et({path:o}))}}},xa=e=>e.Markdown,ya=e=>D(xa,t=>t&&t.markdowns[e]),ts=e=>{const t=V("Store"),{useAppSelector:s}=t.hooks;return s(ya(e))},wa=({path:e,...t})=>{const s=ma();g.useLayoutEffect(()=>{s.loadMarkdown(e)},[e]);const o=ts(e);return!o||o.progress!=="completed"?r.jsx(r.Fragment,{}):r.jsx(co,{...t,remarkPlugins:[lo],children:o.content})},st=I();st.startListening({actionCreator:et,effect:async({payload:e},t)=>{const{dispatch:s}=t;s(Jt({path:e.path}));const n=await(await(await fetch(e.path)).blob()).text();s(tt({path:e.path,content:n}))}});st.startListening({actionCreator:tt,effect:async({payload:e},t)=>{const{dispatch:s,getState:o}=t,{Markdown:{markdowns:n}}=o();s(es(n[e.path]))}});const Ma={progress:"not-started",content:null},Ca={markdowns:{}},ba=T({name:W,initialState:Ca,reducers:{},extraReducers:e=>{e.addCase(et,(t,{payload:{path:s}})=>({...t,markdowns:{...t.markdowns,[s]:{...Ma,path:s}}})),e.addCase(Jt,(t,{payload:{path:s}})=>({...t,markdowns:{...t.markdowns,[s]:{...t.markdowns[s],progress:"started"}}})),e.addCase(tt,(t,{payload:{path:s,content:o}})=>({...t,markdowns:{...t.markdowns,[s]:{...t.markdowns[s],content:o}}})),e.addCase(es,(t,{payload:{path:s}})=>({...t,markdowns:{...t.markdowns,[s]:{...t.markdowns[s],progress:"completed"}}}))}}),Sa=({managers:{storeManager:e}})=>{e.functions.loadReducer(W,ba.reducer),e.functions.registerMiddleware(st)},Da={name:W,version:ha,depends_on:[],components:{MarkdownReader:wa},hooks:{useMarkdown:ts},kernelCalls:{startModule:Sa,restartModule(){},shutdownModule(){}}};export{y as A,Aa as D,Ra as L,Ea as M,Zn as S,Qt as a,me as b,_e as c,kt as d,ye as e,se as f,oe as g,Xo as h,St as i,xe as j,Ze as k,Mt as l,Xe as m,V as n,Ve as o,Va as p,La as q,ke as r,Da as s,Ke as u};
